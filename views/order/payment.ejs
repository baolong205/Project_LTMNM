<%- include('../partials/header') %>

<div class="container mt-4">
    <h3 class="text-center">üí≥ Thanh to√°n</h3>

    <% if (cart && Array.isArray(cart) && cart.length > 0) { %>
        <table class="table table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>T√™n m√≥n</th>
                    <th>S·ªë l∆∞·ª£ng</th>
                    <th>Gi√° (VND)</th>
                    <th>Th√†nh ti·ªÅn (VND)</th>
                </tr>
            </thead>
            <tbody>
                <% cart.forEach((item) => { %>
                    <tr>
                        <td><%= item.name %></td>
                        <td><%= item.quantity %></td>
                        <td><%= item.price.toLocaleString('vi-VN') %></td>
                        <td><%= (item.price * item.quantity).toLocaleString('vi-VN') %></td>
                    </tr>
                <% }) %>
            </tbody>
        </table>

        <h4 class="text-end">
            T·ªïng ti·ªÅn: 
            <%= total > 0 ? total.toLocaleString('vi-VN') : 'N/A' %> VND
        </h4>

        <form action="/order/payment/confirm/<%= tableNumber %>" method="POST">
            <button type="submit" class="btn btn-primary w-100">X√°c nh·∫≠n thanh to√°n</button>
        </form>
    <% } else { %>
        <div class="alert alert-warning text-center">‚ùå Gi·ªè h√†ng tr·ªëng ho·∫∑c kh√¥ng h·ª£p l·ªá.</div>
    <% } %>
</div>

<!-- Success Modal -->
<% if (successMessage) { %>
    <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-sm">
            <div class="modal-content text-center">
                <div class="modal-header bg-success text-white justify-content-center">
                    <h5 class="modal-title w-100" id="successModalLabel">‚úîÔ∏è Th√†nh c√¥ng</h5>
                </div>
                <div class="modal-body fs-5">
                    <%= successMessage %>
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-success px-4" data-bs-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>
<% } %>

<%- include('../partials/footer') %>

<script>
    <% if (successMessage) { %>
        document.addEventListener('DOMContentLoaded', function () {
            var successModal = new bootstrap.Modal(document.getElementById('successModal'), {
                backdrop: 'static',
                keyboard: false
            });
            successModal.show();
        });
    <% } %>
</script>
