<%- include('../partials/header') %>
<head>
  <meta charset="UTF-8" />
  <title>Qu·∫£n l√Ω Menu - Admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
  <div class="container mt-5">
    <h2 class="text-center mb-4 text-primary">üìã Qu·∫£n l√Ω m√≥n ƒÉn</h2>

    <% if (user && user.role === 'Admin') { %>
    <!-- üë• N√∫t qu·∫£n l√Ω nh√¢n vi√™n -->
    <div class="text-end mb-4">
      <a href="/admin/users" class="btn btn-warning">üë• Qu·∫£n l√Ω nh√¢n vi√™n</a>
    </div>

    <div class="card mb-4">
      <div class="card-header">
        <%= editItem ? "S·ª≠a m√≥n ƒÉn" : "Th√™m m√≥n ƒÉn m·ªõi" %>
      </div>
      <div class="card-body">
        <form
          action="<%= editItem ? ('/admin/menu/update/' + editItem.id) : '/admin/menu/add' %>"
          method="POST"
        >
          <div class="row g-3">
            <div class="col-md-3">
              <label class="form-label">T√™n m√≥n</label>
              <input type="text" name="name" class="form-control" value="<%= editItem ? editItem.name : '' %>" required />
            </div>
            <div class="col-md-3">
              <label class="form-label">Lo·∫°i</label>
              <input type="text" name="category" class="form-control" value="<%= editItem ? editItem.category : '' %>" required />
            </div>
            <div class="col-md-3">
              <label class="form-label">Gi√°</label>
              <input type="number" step="1000" name="price" class="form-control" value="<%= editItem ? editItem.price : '' %>" required />
            </div>
            <div class="col-md-3">
              <label class="form-label">Link ·∫£nh m√≥n ƒÉn</label>
              <input type="url" name="image" class="form-control" value="<%= editItem ? editItem.image : '' %>" required />
            </div>
          </div>
          <div class="mt-3 text-end">
            <button class="btn btn-success">
              <%= editItem ? "C·∫≠p nh·∫≠t" : "Th√™m m√≥n" %>
            </button>
          </div>
        </form>
      </div>
    </div>
    <% } %>

    <table class="table table-bordered table-hover align-middle">
      <thead class="table-primary text-center">
        <tr>
          <th>·∫¢nh</th>
          <th>T√™n m√≥n</th>
          <th>Lo·∫°i</th>
          <th>Gi√°</th>
          <% if (user && user.role === 'Admin') { %>
          <th>H√†nh ƒë·ªông</th>
          <% } %>
        </tr>
      </thead>
      <tbody>
        <% menuItems.forEach(item => { %>
        <tr>
          <td class="text-center">
            <% if (item.image) { %>
              <img src="<%= item.image %>" width="80" height="60" style="object-fit: cover" />
            <% } else { %>
              <em>Kh√¥ng c√≥</em>
            <% } %>
          </td>
          <td><%= item.name %></td>
          <td><%= item.category %></td>
          <td><%= item.price ? item.price.toLocaleString('vi-VN') : '0' %> ƒë</td>
          <% if (user && user.role === 'Admin') { %>
          <td class="text-center">
            <a href="/admin/menu/edit/<%= item.id %>" class="action-btn edit-btn">
              <img src="https://img.icons8.com/ios-glyphs/30/ffffff/edit--v1.png" alt="Edit Icon" />
              S·ª¨A
            </a>
            <a href="/admin/menu/delete/<%= item.id %>" class="action-btn delete-btn" onclick="return confirm('Xo√° m√≥n n√†y?')">
              <img src="https://img.icons8.com/ios-glyphs/30/ffffff/trash--v1.png" alt="Delete Icon" />
              XO√Å
            </a>
          </td>
          <% } %>
        </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</body>
<%- include('../partials/footer') %>
